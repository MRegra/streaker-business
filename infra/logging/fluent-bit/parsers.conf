# Generic: attempt to JSON-decode whatever is in "log"
[PARSER]
    Name        docker_inner_json
    Format      json

# Extract 64-char Docker container ID from the file path
[PARSER]
    Name   docker_path_to_id
    Format regex
    Regex  ^/var/lib/docker/containers/(?<container_id>[0-9a-f]{64})/.*$

# Backend: Logback JSON with timestamp
[PARSER]
    Name        json_logback
    Format      json
    Time_Key    timestamp
    Time_Keep   On
    # If timestamp looks like 2025-08-09T16:35:28.123Z:
    Time_Format %Y-%m-%dT%H:%M:%S.%LZ
    # If it includes an offset like +00:00, instead use:
    # Time_Format %Y-%m-%dT%H:%M:%S.%L%z
